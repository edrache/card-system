<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card System - Builder</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <header>
        <h1>Card System Builder</h1>
        <nav>
            <a href="index.html">Tabletop</a>
            <div class="builder-nav">
                <button id="nav-create" class="nav-btn active">Create</button>
                <button id="nav-library" class="nav-btn">Library</button>
                <button id="nav-deck-builder" class="nav-btn">Deck Builder</button>
            </div>
        </nav>
    </header>

    <main class="builder-layout">
        <div id="view-create" class="view-section">
            <div class="create-view-container">
                <section id="card-creator" class="create-column">
                    <h2>Create New Card</h2>
                    <form id="card-form" autocomplete="off">
                        <input type="hidden" id="editing-card-id">
                        <div class="form-group">
                            <label for="card-name">Name</label>
                            <input type="text" id="card-name" required>
                        </div>
                        <div class="form-group">
                            <label for="card-mech-text">Mechanical Text</label>
                            <textarea id="card-mech-text" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="card-flavor-text">Flavor Text</label>
                            <textarea id="card-flavor-text" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="card-tags">Tags (comma separated)</label>
                            <input type="text" id="card-tags">
                        </div>

                        <div class="form-actions">
                            <button type="submit" id="create-btn">Create Card</button>
                            <div id="edit-buttons" class="hidden" style="display: flex; gap: 10px;">
                                <button type="button" id="overwrite-btn" class="warning-btn">Overwrite Existing</button>
                                <button type="button" id="save-as-new-btn">Save as New</button>
                                <button type="button" id="cancel-edit-btn" class="secondary-btn">Cancel Edit</button>
                            </div>
                        </div>
                    </form>
                </section>

                <section id="bulk-import-section" class="create-column">
                    <h3>Bulk Import</h3>
                    <p class="hint">Format: Name | Mechanical Text | Flavor Text | Tags</p>
                    <textarea id="bulk-import" placeholder="Example:
Giant Rat | 2/2 Creature | Squeak | Rat, Beast
Fireball | Deal 3 damage | Whoosh | Spell, Fire" rows="10"></textarea>
                    <button id="import-btn">Import</button>
                </section>
            </div>
        </div>

        <div id="view-library" class="view-section hidden">
            <section id="card-library">
                <h2>Card Library</h2>
                <div class="library-controls">
                    <div class="filters" style="position: relative;">
                        <input type="text" id="search-cards" placeholder="Search cards...">
                        <div class="autocomplete-wrapper" style="position: relative; flex: 1;">
                            <input type="text" id="filter-tags" placeholder="Filter by tag..." autocomplete="off">
                            <div id="tag-suggestions" class="autocomplete-suggestions hidden"></div>
                        </div>
                    </div>
                    <div class="bulk-actions">
                        <button id="delete-selected-btn" class="danger-btn">Delete Selected</button>
                        <select id="add-to-deck-select">
                            <option value="">Add Selected to Deck...</option>
                        </select>
                        <button id="add-selected-btn">Add</button>
                    </div>
                    <div class="bulk-tagging"
                        style="display: flex; gap: 5px; align-items: center; margin-top: 5px; width: 100%;">
                        <input type="text" id="bulk-tag-input" placeholder="Tag to add/remove">
                        <button id="bulk-add-tag-btn">Add Tag</button>
                        <button id="bulk-remove-tag-btn" class="warning-btn">Remove Tag</button>
                    </div>
                    <div class="io-controls" style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee;">
                        <button id="export-library-btn" class="secondary-btn">Export Cards</button>
                        <button id="import-library-btn" class="secondary-btn">Import Cards</button>
                        <input type="file" id="import-library-file" accept=".json" class="hidden">
                    </div>
                </div>

                <div id="library-list" class="card-grid">
                    <!-- List of all created cards -->
                </div>
            </section>
        </div>

        <div id="view-deck-builder" class="view-section hidden">
            <section id="deck-builder">
                <h2>Deck Builder</h2>
                <div class="deck-controls">
                    <input type="file" id="import-decks-file" accept=".json" class="hidden">
                </div>

                <div class="deck-builder-split" style="margin-top:15px; flex:1; min-height:0; display:flex; gap:15px;">
                    <aside class="deck-sidebar"
                        style="width:300px; display:flex; flex-direction:column; gap:10px; border-right:1px solid var(--border-color); padding-right:15px;">
                        <h3>Your Decks</h3>
                        <div id="deck-list" class="deck-list-simple" style="flex:1; overflow-y:auto;">
                            <!-- List of decks -->
                        </div>
                    </aside>
                    <div id="active-deck-view" style="flex:1; overflow-y:auto; padding-left:5px;">
                        <div class="empty-state"
                            style="display:flex; justify-content:center; align-items:center; height:100%; color:var(--text-light);">
                            Select a deck to manage
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Card Preview Modal -->
    <div id="card-preview-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="preview-container"></div>
        </div>
    </div>

    <div id="toast-container"></div>

    <!-- Help System -->
    <button id="help-btn" class="help-btn" title="Help">?</button>

    <div id="help-modal" class="modal hidden">
        <div class="help-modal-content">
            <div class="help-header">
                <h2>Builder Help</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="help-body" id="help-content">
                <!-- Content injected by JS -->
            </div>
        </div>
    </div>

    <script type="module" src="js/builder.js"></script>
</body>

</html>